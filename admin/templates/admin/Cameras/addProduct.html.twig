{% extends 'base.html.twig' %}

{% block title %}Add camera{% endblock %}


{% block stylesheets %}

<style>
    body {
  font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif; 
}
</style>



{% endblock %}
 
{% block body %}
    <div id="layout-wrapper">
        <div class="main-content">
            <div class="page-content">
                <div class="container-fluid">
                    <!-- Start page title -->
                    <div class="row">
                        <div class="col-12">
                            <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                <h4 class="mb-sm-0">Create Product</h4>
                                <div class="page-title-right">
                                    <ol class="breadcrumb m-0">
                                        <li class="breadcrumb-item"><a href="javascript: void(0);">Ecommerce</a></li>
                                        <li class="breadcrumb-item active">Create Product</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End page title -->
                    
                        {{ form_start(form, {'attr': {'id': 'add_camera_form', 'enctype': 'multipart/form-data'}}) }}
                    
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card">
                                <div class="card-body">
                                    <div class="mb-3">
                                        {{ form_label(form.nom) }}
                                        {{ form_widget(form.nom, {'attr': {'class': 'form-control'}}) }}
                                        <div class="form-error">
                                            {{ form_errors(form.nom) }}
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        {{ form_label(form.description) }}
                                        {{ form_widget(form.description, {'attr': {'class': 'form-control'}}) }}
                                         <div class="form-error">
                                            {{ form_errors(form.description) }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- End card -->
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Product Gallery</h5>
                                </div>
                                <div class="card-body">
                                    <div id="drop-area">
                                        <h3>Drag & Drop Files Here</h3>
                                        {{ form_label(formI.imageFile) }}
                                        {{ form_widget(formI.imageFile, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                    <div id="gallery"></div>
                                </div>
                            </div>
                            <!-- End card -->
                            
                            <div class="card">
                                <div class="card-header">
                                    <ul class="nav nav-tabs-custom card-header-tabs border-bottom-0" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" data-bs-toggle="tab" href="#addproduct-general-info" role="tab">
                                                General Info
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-bs-toggle="tab" href="#addproduct-metadata" role="tab">
                                                Meta Data
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- End card header -->
                                <div class="card-body">
                                    <div class="tab-content">
                                        <div class="tab-pane active" id="addproduct-general-info" role="tabpanel">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="mb-3">
                                                        {{ form_label(form.prix) }}
                                                        {{ form_widget(form.prix, {'attr': {'class': 'form-control'}}) }}
                                                      <div class="form-error">
                                                        {{ form_errors(form.prix) }}
                                                    </div>  
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="mb-3">
                                                        {{ form_label(form.stock) }}
                                                        {{ form_widget(form.stock, {'attr': {'class': 'form-control'}}) }}
                                                        <div class="form-error">
                                                        {{ form_errors(form.stock) }}
                                                    </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- End row -->
                                            
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="mb-3">
                                                        {{ form_label(form.resolution) }}
                                                        {{ form_widget(form.resolution, {'attr': {'class': 'form-control'}}) }}
                                                   <div class="form-error">
                                                        {{ form_errors(form.resolution) }}
                                                    </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="mb-3">
                                                        {{ form_label(form.status) }}
                                                        {{ form_widget(form.status, {'attr': {'class': 'form-control'}}) }}
                                                        <div class="form-error">
                                                                {{ form_errors(form.status) }}
                                                            </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- End row -->
                                        </div>
                                        <!-- End tab-pane -->
                                        
                                        <div class="tab-pane" id="addproduct-metadata" role="tabpanel">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="mb-3">
                                                        {{ form_label(form.couleur) }}
                                                        {{ form_widget(form.couleur, {'attr': {'class': 'form-control'}}) }}
                                                   <div class="form-error">
                                                        {{ form_errors(form.couleur) }}
                                                    </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        {{ form_label(form.stockage) }}
                                                        {{ form_widget(form.stockage, {'attr': {'class': 'form-control'}}) }}
                                                  <div class="form-error">
                                                        {{ form_errors(form.stockage) }}
                                                    </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="mb-3">
                                                        {{ form_label(form.visionNoctrune) }}
                                                        {{ form_widget(form.visionNoctrune, {'attr': {'class': 'form-control'}}) }}
                                                    <div class="form-error">
                                                        {{ form_errors(form.visionNoctrune) }}
                                                    </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        {{ form_label(form.poids) }}
                                                        {{ form_widget(form.poids, {'attr': {'class': 'form-control'}}) }}
                                                    <div class="form-error">
                                                        {{ form_errors(form.poids) }}
                                                    </div>
                                                    </div>
                                         </div>
                                            </div>
                                            <!-- End row -->
                                        </div>
                                        <!-- End tab-pane -->
                                    </div>
                                    <!-- End tab-content -->
                                </div>
                                <!-- End card-body -->
                            </div>
                            <!-- End card -->
                        </div>
                        <!-- End col-lg-8 -->
                        
                        <div class="col-lg-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Publish</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="choices-publish-status-input" class="form-label">{{ form_label(form.alimentation) }}</label>
                                        {{ form_widget(form.alimentation, {'attr': {'class': 'form-control'}}) }}
                                  <div class="form-error">
                                                        {{ form_errors(form.alimentation) }}
                                                    </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="choices-publish-visibility-input" class="form-label">{{ form_label(form.angleVision) }}</label>
                                        {{ form_widget(form.angleVision, {'attr': {'class': 'form-control'}}) }}
                                   <div class="form-error">
                                                        {{ form_errors(form.angleVision) }}
                                                    </div>
                                    </div>
                                </div>
                                <!-- End card-body -->
                            </div>
                            <!-- End card -->
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Publish Date</h5>
                                </div>
                                <!-- End card-header -->
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="datepicker-publish-input" class="form-label">{{ form_label(form.dateAjout) }}</label>
                                        {{ form_widget(form.dateAjout, {'attr': {'class': 'form-control'}}) }}
                                  <div class="form-error">
                                                        {{ form_errors(form.dateAjout) }}
                                                    </div>
                                    </div>
                                </div>
                                <!-- End card-body -->
                            </div>
                            <!-- End card -->
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Product Categories</h5>
                                </div>
                                <!-- End card-header -->
                                <div class="card-body">
                                    <p class="text-muted mb-2">{{ form_label(form.categorie) }}</p>
                                    {{ form_widget(form.categorie, {'attr': {'class': 'form-control'}}) }}
                                    <div class="form-error">
                                                        {{ form_errors(form.categorie) }}
                                                    </div>
                                </div>
                                <!-- End card-body -->
                            </div>
                            <!-- End card -->
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">{{ form_label(form.connectivite) }}</h5>

                                </div>
                                <!-- End card-header -->
                                <div class="card-body">
                                    <div class="hstack gap-3 align-items-start">
                                        <div class="flex-grow-1">
                                            {{ form_widget(form.connectivite, {'attr': {'class': 'form-control'}}) }}
                                            <div class="form-error">
                                                        {{ form_errors(form.connectivite) }}
                                                    </div>
                                        </div>
                                    </div>
                                </div>
                                  <div class="card-body">
                                    <div class="hstack gap-3 align-items-start">
                                        <div class="flex-grow-1">
                                        {{ form_end(form) }}
                                        </div>
                                    </div>
                                </div>
                                <!-- End card-body -->
                            </div>
                            <!-- End card -->

                            <div class="text-end mb-3">
                                <button type="submit" class="btn btn-success">Enregistrer</button>
                                <a href="{{ path('camera') }}" class="btn btn-secondary">Annuler</a>
                            </div>
                            {% for child in form %}
                                {% if child.vars.errors|length > 0 %}
                                    <div class="alert alert-danger" role="alert">
                                        {% for error in child.vars.errors %}
                                            {{ error.message }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <!-- End col-lg-4 -->
                    </div>
                    <!-- End row -->
                    
                    
                </div>
                <!-- End container-fluid -->
            </div>
            <!-- End page-content -->
        </div>
        <!-- End main-content -->
    </div>
    <!-- End layout-wrapper -->

{% endblock %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
$(document).ready(function() {
    $('#add_camera_form').on('submit', function (e) {
        e.preventDefault(); // Empêcher la soumission du formulaire par défaut
                
        $.ajax({
            url: $(this).attr('action'),
            type: $(this).attr('method'),
            data: $(this).serialize(),
            success: function (response) {
                // Afficher une alerte SweetAlert2 avec un message de succès
                Swal.fire({
                    title: 'Succès!',
                    text: 'Caméra ajoutée avec succès!',
                    icon: 'success',
                    confirmButtonText: 'OK'
                }).then((result) => {
                    // Rediriger l'utilisateur après l'ajout réussi
                    window.location.href = "{{ path('camera') }}";
                });
            },
            error: function () {
                // Afficher une alerte SweetAlert2 en cas d'erreur
                Swal.fire({
                    title: 'Erreur!',
                    text: 'Une erreur est survenue lors de l\'ajout de la caméra.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        });
    });
});

    </script>
{% endblock %}
